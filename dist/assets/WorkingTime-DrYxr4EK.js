import{a as k}from"./axios-CCb-kr4I.js";import{d as c,f as s,E as l,x as T,g as o,j as r,v,D as V,B as w,J as p,a1 as g,e as n}from"./@vue-C1_HKBMx.js";import{_ as S}from"./index-DMSs4jwp.js";import"./pinia-DoMM712Q.js";import"./bootstrap-CJ3D_gRJ.js";import"./@popperjs-WhmJkuoZ.js";import"./bootstrap-vue-3-C4nBWjFx.js";import"./vue-router-yQ3pcn0R.js";import"./vue-chartjs-CXOf9EPh.js";import"./chart.js-BuLztui6.js";import"./@kurkle-BZxJdD1U.js";import"./vue-toastification-COUycyGz.js";/* empty css                        *//* empty css                     */import"./@vuepic-DXhf3Elp.js";const $=c({props:{userId:{type:String,required:!0}},data(){return{workingTimes:[],newWorkingTime:{startTime:"",endTime:""},updatedWorkingTime:{startTime:"",endTime:""},errorMessage:"",editingId:null,isFormVisible:!1,show:!0}},created(){this.getWorkingTimes()},methods:{toggleForm(){this.isFormVisible=!this.isFormVisible},onSubmit(e){e.preventDefault(),alert(JSON.stringify(this.newWorkingTime))},onReset(){this.newWorkingTime.date="",this.newWorkingTime.startTime="",this.newWorkingTime.endTime="",this.show=!1,this.$nextTick(()=>{this.show=!0})},async getWorkingTimes(){try{const e=await k.get(`http://localhost:4000/api/workingtime/${this.userId}`).then(({data:i})=>i.data).then(i=>{console.log("Data:",i),this.workingTimes=i});console.log("Working times loaded:",this.workingTimes)}catch(e){console.error("Error fetching working times:",e),this.errorMessage="Failed to load working times. Please try again later."}},async createWorkingTime(){if(!this.newWorkingTime.startTime||!this.newWorkingTime.endTime){this.errorMessage="Start time and end time cannot be empty.";return}const e=new Date(`${this.newWorkingTime.date} ${this.newWorkingTime.startTime}`);if(new Date(`${this.newWorkingTime.date} ${this.newWorkingTime.endTime}`)<=e){this.errorMessage="End time must be after start time.";return}try{await k.post(`/api/workingtime/${this.userId}`,{workingtime:{start:new Date(`${this.newWorkingTime.date} ${this.newWorkingTime.startTime}`).toISOString(),end:new Date(`${this.newWorkingTime.date} ${this.newWorkingTime.endTime}`).toISOString()}}),await this.getWorkingTimes(),this.onReset(),this.isFormVisible=!1}catch(u){console.error("Error creating working time:",u),this.errorMessage="Failed to create working time. Please try again."}},async updateWorkingTime(e,i,u){try{await k.put(`/api/workingtime/${e}`,{workingtime:{start:new Date(`${this.updatedWorkingTime.date} ${this.updatedWorkingTime.startTime}`).toISOString(),end:new Date(`${this.updatedWorkingTime.date} ${this.updatedWorkingTime.endTime}`).toISOString()}}),await this.getWorkingTimes(),this.editingId=null}catch(f){console.error("Error updating working time:",f)}},async deleteWorkingTime(e){try{await k.delete(`/api/workingtime/${e}`),await this.getWorkingTimes()}catch(i){console.error("Error deleting working time:",i)}},startEditing(e){this.editingId=e},stopEditing(e,i,u){this.updateWorkingTime(e,i,u)},formatDate(e){return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"})},formatHour(e){return new Date(e).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}}}),D={class:"working-time"},I={key:0,class:"alert alert-danger mt-3"},E={key:1,class:"mt-3"},C={key:2,class:"mt-3"},M={key:0},F={key:1},Y={key:0},_={key:1},q={key:0},R={key:1},U={key:0},B={key:1};function H(e,i,u,f,N,O){const d=g("b-button"),m=g("b-form-input"),h=g("b-form-group"),W=g("b-form"),b=g("b-badge"),y=g("b-table");return n(),s("div",D,[e.errorMessage?(n(),s("div",I,l(e.errorMessage),1)):T("",!0),o(d,{variant:"primary",onClick:e.toggleForm,class:"mt-3"},{default:r(()=>[p(l(e.isFormVisible?"Cancel":"Add Working Time"),1)]),_:1},8,["onClick"]),e.isFormVisible?(n(),s("div",E,[e.show?(n(),v(W,{key:0,onSubmit:[V(e.createWorkingTime,["prevent"]),e.onSubmit],onReset:e.onReset},{default:r(()=>[o(h,{id:"input-group-1",label:"Working Date:","label-for":"input-1"},{default:r(()=>[o(m,{id:"input-1",modelValue:e.newWorkingTime.date,"onUpdate:modelValue":i[0]||(i[0]=t=>e.newWorkingTime.date=t),"date-format":"YYYY-MM-DD",type:"date",placeholder:"Select date",required:""},null,8,["modelValue"])]),_:1}),o(h,{id:"input-group-1",label:"Start Hour:","label-for":"input-1"},{default:r(()=>[o(m,{id:"input-1",modelValue:e.newWorkingTime.startTime,"onUpdate:modelValue":i[1]||(i[1]=t=>e.newWorkingTime.startTime=t),type:"time",placeholder:"Select start time",required:""},null,8,["modelValue"])]),_:1}),o(h,{id:"input-group-1",label:"End Hour:","label-for":"input-1"},{default:r(()=>[o(m,{id:"input-1",modelValue:e.newWorkingTime.endTime,"onUpdate:modelValue":i[2]||(i[2]=t=>e.newWorkingTime.endTime=t),type:"time",placeholder:"Select end time",required:""},null,8,["modelValue"])]),_:1}),o(d,{type:"submit",variant:"primary"},{default:r(()=>i[6]||(i[6]=[p("Submit")])),_:1}),o(d,{class:"reset-button",type:"reset",variant:"danger"},{default:r(()=>i[7]||(i[7]=[p("Reset")])),_:1})]),_:1},8,["onSubmit","onReset"])):T("",!0)])):T("",!0),e.workingTimes.length>0?(n(),s("div",C,[w("h3",null,[i[8]||(i[8]=p("Existing Working Times for ")),o(b,null,{default:r(()=>[p(l(e.userId),1)]),_:1})]),o(y,{striped:"",hover:"",items:e.workingTimes,fields:["date","startTime","endTime","actions"]},{"cell(date)":r(t=>[e.editingId===t.item.id?(n(),s("div",M,[o(m,{id:"input-1",modelValue:e.updatedWorkingTime.date,"onUpdate:modelValue":i[3]||(i[3]=a=>e.updatedWorkingTime.date=a),"date-format":"YYYY-MM-DD",type:"date",placeholder:"Select date",required:""},null,8,["modelValue"])])):(n(),s("div",F,l(e.formatDate(t.item.start)),1))]),"cell(startTime)":r(t=>[e.editingId===t.item.id?(n(),s("div",Y,[o(m,{modelValue:e.updatedWorkingTime.startTime,"onUpdate:modelValue":i[4]||(i[4]=a=>e.updatedWorkingTime.startTime=a),type:"time"},null,8,["modelValue"])])):(n(),s("div",_,l(e.formatHour(t.item.start)),1))]),"cell(endTime)":r(t=>[e.editingId===t.item.id?(n(),s("div",q,[o(m,{modelValue:e.updatedWorkingTime.endTime,"onUpdate:modelValue":i[5]||(i[5]=a=>e.updatedWorkingTime.endTime=a),type:"time",onInput:a=>e.stopEditing(t.item.id,t.item.start,t.item.end)},null,8,["modelValue","onInput"])])):(n(),s("div",R,l(e.formatHour(t.item.end)),1))]),"cell(actions)":r(t=>[e.editingId===t.item.id?(n(),s("div",U,[o(d,{size:"sm",variant:"success",onClick:a=>e.stopEditing(t.item.id,t.item.start,t.item.end),title:"Save"},{default:r(()=>i[9]||(i[9]=[w("i",{class:"bi bi-check"},null,-1)])),_:2},1032,["onClick"])])):(n(),s("div",B,[o(d,{size:"sm",variant:"link",onClick:a=>e.startEditing(t.item.id),title:"Edit"},{default:r(()=>i[10]||(i[10]=[w("i",{class:"bi bi-pencil-square"},null,-1)])),_:2},1032,["onClick"]),o(d,{size:"sm",variant:"danger",onClick:a=>e.deleteWorkingTime(t.item.id),title:"Delete"},{default:r(()=>i[11]||(i[11]=[w("i",{class:"bi bi-trash"},null,-1)])),_:2},1032,["onClick"])]))]),_:1},8,["items"])])):T("",!0)])}const oe=S($,[["render",H],["__scopeId","data-v-4750a92a"]]);export{oe as default};
